---
title: 일괄 추출
feature: REST API
description: Marketo 벌크 추출 REST API를 사용하여 OAuth, 작업 큐 및 500MB 일일 제한으로 리드, 활동, 프로그램 멤버 및 사용자 지정 개체를 내보내는 방법에 대해 알아봅니다.
exl-id: 6a15c8a9-fd85-4c7d-9f65-8b2e2cba22ff
source-git-commit: 7557b9957c87f63c2646be13842ea450035792be
workflow-type: tm+mt
source-wordcount: '1702'
ht-degree: 0%

---

# 일괄 추출

Marketo은 대량 추출이라고 하는 대규모 개인 및 개인 관련 데이터 세트를 검색할 수 있는 인터페이스를 제공합니다. 현재 인터페이스는 다음 세 가지 객체 유형에 대해 제공됩니다.

- 잠재 고객 (개인)
- 활동
- 프로그램 구성원
- 사용자 지정 개체

대량 추출은 작업을 만들고, 검색할 데이터 세트를 정의하고, 작업을 큐에 넣고, 작업이 파일 쓰기를 완료할 때까지 기다린 다음 HTTP를 통해 파일을 검색하여 수행됩니다. 이러한 작업은 비동기적으로 실행되며 폴링하여 내보내기 상태를 검색할 수 있습니다.

`Note:` 대량 API 끝점에는 다른 끝점처럼 &#39;/rest&#39; 접두사가 없습니다.

## 인증

벌크 추출 API는 다른 Marketo REST API와 동일한 OAuth 2.0 인증 방법을 사용합니다. HTTP 헤더 `Authorization: Bearer {_AccessToken_}`(으)로 전송하려면 올바른 액세스 토큰이 필요합니다.

>[!IMPORTANT]
>
>**access_token** 쿼리 매개 변수를 사용하는 인증 지원이 2025년 6월 30일에 제거됩니다. 프로젝트에서 쿼리 매개 변수를 사용하여 액세스 토큰을 전달하는 경우 가능한 한 빨리 **인증** 헤더를 사용하도록 업데이트해야 합니다. 새 개발에서는 **Authorization** 헤더만 사용해야 합니다.

## 제한

- 최대 동시 내보내기 작업: 2
- 큐에 있는 최대 내보내기 작업(현재 내보내기 작업 포함): 10
- 파일 보존 기간: 7일
- 기본 일별 내보내기 할당: 500MB(12:00AM CST에서 매일 재설정). 구매 가능한 증가.
- 날짜 범위 필터의 최대 시간 범위(createdAt 또는 updatedAt): 31일

UpdatedAt 및 Smart List에 대한 대량 리드 추출 필터는 일부 구독 유형에서 사용할 수 없습니다. 사용할 수 없는 경우 리드 작업 만들기 끝점에 대한 호출에서 &quot;1035, 대상 구독에 대해 지원되지 않는 필터 유형&quot; 오류를 반환합니다. 고객은 Marketo 지원 센터에 문의하여 구독에서 이 기능을 활성화할 수 있습니다.

### 큐

벌크 추출 API는 작업 큐(리드, 활동, 프로그램 멤버 및 사용자 지정 개체 간에 공유됨)를 사용합니다. 추출 작업을 먼저 만든 다음 [리드/활동/프로그램 멤버 작업 내보내기 생성] 및 [리드/활동/프로그램 멤버 작업 내보내기 끝점 큐에 넣기]를 호출하여 큐에 넣어야 합니다. 대기열에 넣으면 작업이 대기열에서 제거되고 컴퓨팅 리소스를 사용할 수 있게 되면 시작됩니다.

큐의 최대 작업 수는 10개입니다. 대기열이 가득 찼을 때 작업을 대기열에 넣으려고 하면 대기열에 넣기 내보내기 작업 끝점이 &quot;1029, 큐에 작업이 너무 많습니다&quot; 오류를 반환합니다. 최대 두 개의 작업을 동시에 실행할 수 있습니다(상태는 &quot;처리 중&quot;).

### 파일 크기

대량 추출 API는 대량 추출 작업에 의해 검색된 데이터의 디스크 크기를 기반으로 측정됩니다. 내보내기 작업의 완료된 상태 응답에서 `fileSize` 특성을 읽은 후 작업에 대한 명시적 크기(바이트)를 결정할 수 있습니다.

일일 할당량은 일일 최대 500MB이며 리드, 활동, 프로그램 멤버 및 사용자 정의 객체 간에 공유됩니다. 할당량이 초과되면 일일 할당량이 자정 [중부 시간](https://en.wikipedia.org/wiki/Central_Time_Zone)에 재설정될 때까지 다른 작업을 만들거나 대기열에 넣을 수 없습니다. 그때까지 &quot;1029, 일일 내보내기 할당량 초과&quot; 오류가 반환됩니다. 일일 할당량 외에 최대 파일 크기는 없습니다.

작업이 대기열에 있거나 처리되면 완료될 때까지 실행됩니다(오류 또는 작업 취소 제외). 어떤 이유로 작업이 실패하면 다시 만들어야 합니다. 작업이 완료된 상태에 도달할 때만 파일이 완전히 작성됩니다(일부 파일은 기록되지 않음). SHA-256 해시를 계산하고 작업 상태 끝점에서 반환되는 체크섬과 비교하여 파일이 완전히 작성되었는지 확인할 수 있습니다.

리드/활동/프로그램 멤버 작업 내보내기 가져오기 를 호출하여 현재 날짜에 사용된 총 디스크 양을 확인할 수 있습니다. 이러한 엔드포인트는 지난 7일 동안의 모든 작업 목록을 반환합니다. `status` 및 `finishedAt` 특성을 사용하여 해당 목록을 현재 완료된 작업으로만 필터링할 수 있습니다. 그런 다음 해당 작업에 대한 파일 크기를 합하여 총 사용량을 생성합니다. 파일을 삭제하여 디스크 공간을 다시 확보할 수 있는 방법은 없습니다.

## 권한

대량 추출은 Marketo REST API와 동일한 권한 모델을 사용하며, 각 끝점 세트에 특정 권한이 필요하지만 사용할 추가 특수 권한이 필요하지 않습니다.

대량 추출 작업은 상태 폴링 및 파일 내용 검색을 포함하여 이를 생성한 API 사용자만 액세스할 수 있습니다.

벌크 추출 종단점이 Marketo 작업 공간을 인식하지 못합니다. 추출 요청에는 사용자 정의 서비스에 대한 API 전용 사용자를 정의하는 방법에 관계없이 모든 작업 영역에 걸쳐 항상 데이터가 포함됩니다.

## 작업 생성

Marketo의 벌크 추출 API는 데이터 추출을 시작하고 실행하는 작업 개념을 사용합니다. 간단한 리드 내보내기 작업을 만드는 방법을 살펴보도록 하겠습니다.

```
POST /bulk/v1/leads/export/create.json
```

```json
{
   "fields": [
      "firstName",
      "lastName"
   ],
   "format": "CSV",
   "columnHeaderNames": {
      "firstName": "First Name",
      "lastName": "Last Name"
   },
   "filter": {
      "createdAt": {
         "startAt": "2023-01-01T00:00:00Z",
         "endAt": "2023-01-31T00:00:00Z"
      }
   }
}
```

이 간단한 요청은 &quot;firstName&quot; 및 &quot;lastName&quot; 필드에 포함된 값을 반환하는 작업을 구성하며, 열 헤더 &quot;First Name&quot; 및 &quot;Last Name&quot;은 CSV 파일로 사용하며 여기에는 2023년 1월 1일부터 2023년 1월 31일 사이에 생성된 각 잠재 고객이 포함됩니다.

```json
{
   "requestId": "e42b#14272d07d78",
   "success": true,
   "result": [
      {
         "exportId": "ce45a7a1-f19d-4ce2-882c-a3c795940a7d",
         "status": "Created",
         "createdAt": "2023-01-21T11:47:30-08:00",
         "queuedAt": "2023-01-21T11:48:30-08:00",
         "format": "CSV",
      }
   ]
}
```

작업을 만들 때 `exportId` 특성에 작업 ID가 반환됩니다. 그런 다음 이 작업 ID를 사용하여 작업을 대기열에 넣거나, 취소하거나, 상태를 확인하거나, 완료된 파일을 검색할 수 있습니다.

### 일반 매개 변수

각 작업 생성 끝점은 대량 추출 작업의 파일 형식, 필드 이름 및 필터를 구성하기 위한 몇 가지 일반적인 매개 변수를 공유합니다. 추출 작업의 각 하위 유형에는 추가 매개 변수가 있을 수 있습니다.

| 매개변수 | 데이터 유형 | 참고 |
|---|---|---|
| 형식 | 문자열 | 쉼표로 구분된 값, 탭으로 구분된 값 및 세미콜론으로 구분된 값에 대한 옵션을 사용하여 추출된 데이터의 파일 형식을 결정합니다. CSV, SSV, TSV 중 하나를 허용합니다. 형식은 기본적으로 CSV로 설정됩니다. |
| 열 머리글 이름 | 오브젝트 | 반환된 파일에서 열 헤더의 이름을 설정할 수 있습니다. 각 멤버 키는 이름을 바꿀 열 헤더의 이름이고 값은 열 헤더의 새 이름입니다. 예를 들어 &quot;columnHeaderNames&quot;: { &quot;firstName&quot;: &quot;First Name&quot;, &quot;lastName&quot;: &quot;Last Name&quot; }, |
| filter | 오브젝트 | 추출 작업에 적용된 필터. 작업 유형에 따라 유형과 옵션이 달라집니다. |

## 작업 검색 중

경우에 따라 최근 작업을 검색해야 할 수 있습니다. 해당 객체 유형에 대한 내보내기 작업 가져오기를 사용하여 쉽게 수행할 수 있습니다. 각 내보내기 작업 가져오기 끝점은 `status` 필터 필드인  반환된 작업 수를 제한하려면 `batchSize`을(를) 사용하고, 큰 결과 집합을 통해 페이징하려면 `nextPageToken`을(를) 사용합니다. 상태 필터는 내보내기 작업에 대해 생성됨, 큐에 있음, 처리, 취소됨, 완료됨 및 실패의 각 유효한 상태를 지원합니다. batchSize의 최대 및 기본값은 300입니다. 리드 내보내기 작업 목록을 가져오겠습니다.

```
GET /bulk/v1/leads/export.json?status=Completed,Failed
```

```json
{
   "requestId": "e42b#14272d07d78",
   "success": true,
   "result": [
      {
         "exportId": "ce45a7a1-f19d-4ce2-882c-a3c795940a7d",
         "status": "Completed",
         "createdAt": "2017-01-21T11:47:30-08:00",
         "queuedAt": "2017-01-21T11:48:30-08:00",
         "startedAt": "2017-01-21T11:51:30-08:00",
         "finishedAt": "2017-01-21T12:59:30-08:00",
         "format": "CSV",
         "numberOfRecords": 122323,
         "fileSize": 123424,
         "fileChecksum": "sha256:c16514c7e80fcac5ea055dacae9617fc3c29aff5365e3743071313ce0ed2a815"
      }
      ...
   ]
}
```

끝점이 결과 배열의 해당 개체 유형에 대해 지난 7일 동안 만들어진 각 작업의 `status` 응답에 응답합니다. 응답에는 호출을 수행하는 API 사용자가 소유한 작업에 대한 결과만 포함됩니다.

## 작업 시작

이제 작업 ID를 사용하여 다음 작업을 시작하겠습니다.

```
POST /bulk/v1/leads/export/{exportId}/enqueue.json
```

이렇게 하면 작업 실행이 시작되고 상태 응답이 다시 반환됩니다. 내보내기는 항상 비동기식으로 수행되므로 작업의 상태를 폴링하여 완료 여부를 확인해야 합니다. 지정된 작업의 상태가 60초마다 두 번 이상 업데이트되지 않으므로 이보다 자주 폴링해서는 안 됩니다. 그러나 대부분의 사용 사례에서는 5분마다 두 번 이상 폴링을 자주 수행하지 않아도 된다는 점을 명심하십시오. 성공한 각 내보내기의 데이터는 10일 동안 유지됩니다.

## 폴링 작업 상태

작업 상태를 확인하는 것은 간단합니다.

상태를 만든 동일한 API 사용자가 만든 작업에 대해서만 상태를 폴링할 수 있습니다.

```
GET /bulk/v1/leads/export/{exportId}/status.json
```

```json
{
   "requestId": "e42b#14272d07d78",
   "success": true,
   "result": [
      {
         "exportId": "ce45a7a1-f19d-4ce2-882c-a3c795940a7d",
         "status": "Completed",
         "createdAt": "2017-01-21T11:47:30-08:00",
         "queuedAt": "2017-01-21T11:48:30-08:00",
         "startedAt": "2017-01-21T11:51:30-08:00",
         "finishedAt": "2017-01-21T12:59:30-08:00",
         "format": "CSV",
         "numberOfRecords": 122323,
         "fileSize": 123424,
         "fileChecksum": "sha256:d9c73f0b6960c71623c8bafe29603b3e8e20fd0e4eeaefd119c0227506ea9be4"
      }
   ]
}
```

내부 `status` 구성원은 작업의 진행 상태를 나타내며 Created, Queued, Processing, Cancelled, Completed, Failed 값 중 하나일 수 있습니다. 이 경우 작업이 완료되었으므로 폴링을 중단하고 계속 파일을 검색할 수 있습니다. 완료되면 `fileSize` 멤버는 파일의 전체 길이를 바이트 단위로 나타내며 `fileChecksum` 멤버는 파일의 SHA-256 해시를 포함합니다. 작업 상태는 완료됨 또는 실패 상태에 도달한 후 30일 동안 사용할 수 있습니다.

## 데이터 검색 중

작업이 완료되면 파일을 쉽게 검색할 수 있습니다.

```
GET /bulk/v1/leads/export/{exportId}/file.json
```

응답에는 작업이 구성된 방식으로 포맷된 파일이 포함됩니다. 끝점이 파일의 내용에 응답합니다. 작업이 완료되지 않았거나 잘못된 작업 ID가 전달된 경우 파일 엔드포인트는 404 찾을 수 없음 상태로 응답하고 대부분의 다른 Marketo REST 엔드포인트와 달리 일반 텍스트 오류 메시지를 페이로드로 표시합니다.

추출된 데이터의 부분 검색 및 재개 친화적인 검색을 지원하기 위해 파일 끝점은 선택적으로 `Range` 유형의 HTTP 헤더 `bytes`을(를) 지원합니다([RFC 7233](https://datatracker.ietf.org/doc/html/rfc7233)에 따라). 헤더가 설정되지 않은 경우 전체 콘텐츠가 반환됩니다. 파일의 처음 10,000바이트를 검색하려면 바이트 0부터 다음 헤더를 GET 요청의 일부로 엔드포인트에 전달합니다.

```
Range: bytes=0-9999
```

부분 파일을 검색할 때 끝점은 상태 코드 206에 응답하고 Accept-ranges, Content-Length 및 Content-Range 헤더를 반환합니다.

```
Accept-Ranges: bytes
Content-Length: 1000
Content-Range: bytes 0-9999/123424
```

### 부분 검색 및 재개

`Range` 헤더를 사용하여 파일을 부분적으로 검색하거나 나중에 다시 시작할 수 있습니다. 파일 범위는 바이트 0에서 시작하여 `fileSize`에서 1을 뺀 값으로 끝납니다. 파일 길이는 내보내기 파일 가져오기 끝점을 호출할 때 `Content-Range` 응답 헤더의 값에 분모로 보고됩니다. 읽어들이기가 부분적으로 실패하면 나중에 다시 시작할 수 있습니다. 예를 들어 1000바이트 길이의 파일을 검색하려고 하지만 처음 725바이트만 받은 경우 끝점을 다시 호출하고 새 범위를 전달하여 실패 지점에서 검색을 재시도할 수 있습니다.

```
Range: bytes 724-999
```

파일의 나머지 275바이트를 반환합니다.

#### 파일 무결성 확인

`fileChecksum`이(가) &quot;완료됨&quot;일 때 작업 상태 끝점이 `status` 특성에 체크섬을 반환합니다. 체크섬은 내보낸 파일의 SHA-256 해시입니다. 검색된 파일의 SHA-256 해시와 체크섬을 비교하여 파일이 완료되었는지 확인할 수 있습니다.

다음은 체크섬을 포함하는 예제 응답입니다.

```json
{
    "exportId": "45547609-6732-418a-bb7b-17b0160b2317",
    "format": "CSV",
    "status": "Completed",
    "createdAt": "2019-06-04T23:13:12Z",
    "queuedAt": "2019-06-04T23:14:02Z",
    "startedAt": "2019-06-04T23:15:19Z",
    "finishedAt": "2019-06-04T23:36:40Z",
    "numberOfRecords": 1776,
    "fileSize": 400785,
    "fileChecksum": "sha256:83aca1351c9398d2770330e21a9e278880fd2f1eeaf8c8238bf7676d5c21d1c6"
}
```

다음은 sha256sum 명령줄 유틸리티를 사용하여 &quot;bulk_lead_export.csv&quot;라는 검색된 파일의 SHA-256 해시를 만드는 예제입니다.

```
$ sha256sum bulk_lead_export.csv
83aca1351c9398d2770330e21a9e278880fd2f1eeaf8c8238bf7676d5c21d1c6 *bulk_lead_export.csv
```

## 작업 취소

작업이 잘못 구성되었거나 불필요하게 된 경우 쉽게 취소할 수 있습니다.

```
POST /bulk/v1/leads/export/{exportId}/cancel.json
```

```json
{
   "requestId": "e42b#14272d07d78",
   "success": true,
   "result": [
      {
         "exportId": "ce45a7a1-f19d-4ce2-882c-a3c795940a7d",
         "status": "Cancelled",
         "createdAt": "2017-01-21T11:47:30-08:00",
         "format": "CSV",
      }
   ]
}
```

작업이 취소되었음을 나타내는 상태로 응답합니다.
